---
title: iOS 프로그래밍 실무 6주차
author: Ki-Chang Kim (Panther K)
date: 2025-04-09 14:00 +0900
categories: [College, iOS]
tags: [college, ios, swift]
---

## 옵셔널 체이닝 (Optional Chaining)

- 옵셔널 타입으로 정의된 값이 프로퍼티나 메서드를 가지고 있을 때, 다중 if를 쓰지 않고 간결하게 코드를 작성하기 위해 사용
- 옵셔널 타입의 데이터는 연산이 불가능
  - 연산을 하기 위해서는 옵셔널을 해제해야 하는데, 많은 양의 옵셔널 타입의 데이터의 경우 다시 한번 옵셔널 타입으로 변경을 하면서 해제를 시켜줌

### 옵셔널 체이닝을 지원하는 언어

#### Javascript

- ?. 연산자를 이용하여 옵셔널 체이닝 구현

```javascript
const user = {
    profile: {
        name: 'Alice'
    }
};
const userName = user.profile?.name; // 'Alice'
const userAge = user.profile?.age;   // undefined (오류 발생하지 않음)
```

#### Typescript

- ? 연산자를 이용하여 옵셔널 체이닝 구현

```typescript
interface User {
    profile?: {
        name: string;
        age?: number;
    };
}
const user: User = {};
const userName = user.profile?.name; // undefined
```

#### Python

- 직접적인 옵셔널 체이닝 문법은 없지만 getattr을 사용해 유사한 기능 구현

```python
user = {'profile': {'name': 'Alice'}}
user_name = user.get('profile', {}).get('name')  # 'Alice'
user_age = user.get('profile', {}).get('age')    # None
```

### Kotlin

- ?. 연산자를 이용해 옵셔널 체이닝 구현

```kotlin
data class Profile(val name: String?, val age: Int?)
data class User(val profile: Profile?)
val user: User? = User(null)
val userName = user?.profile?.name // null
```

### 옵셔널을 언래핑하는 방법

```swift
var x: String? = "Hi" // 옵셔널 문자열 변수 x를 선언하고 "Hi"로 초기화
print(x, x!) // x의 값과 x를 강제 언래핑한 값을 출력 (x가 nil이 아닐 때만 안전함)

if let a = x { // x가 nil이 아닐 경우에만 a에 값을 할당
    print(a) // a의 값을 출력 (여기서는 "Hi"가 출력됨)
}

let b = x!.count // x를 강제 언래핑하고 그 문자열의 길이를 b에 할당
print(type(of: b), b) // b의 타입과 값을 출력 (Int, 2)

let b1 = x?.count // x가 nil이 아닐 경우에만 count를 계산하여 b1에 할당
print(type(of: b1), b1, b1!) // b1의 타입과 값을 출력 (Optional<Int>, 2, 2)

let c = x ?? "" // x가 nil일 경우 빈 문자열을 c에 할당
print(c) // c의 값을 출력 (여기서는 "Hi"가 출력됨)
```

### ?와 !의 선언문과 실행문에서의 차이점

|  구분  |        `?` (옵셔널)        |        `!` (강제 언래핑)        |
|:------:|:--------------------------:|:-------------------------------:|
| 선언문 | `var name: String?`       | `var name: String!`            |
|        | - nil 값을 가질 수 있음    | - nil이 아님을 보장             |
| 실행문 | `let length = name?.count` | `let length = name!.count`     |
|        | - nil일 경우 nil 반환      | - nil일 경우 런타임 오류 발생  |

### ?와 !의 비교

|   구분   |          `var x: Int!`          |          `var x: Int?`          |
|:--------:|:---------------------------------:|:---------------------------------:|
|  **타입**  | 암시적 언래핑 옵셔널 (Implicitly Unwrapped Optional) | 옵셔널 (Optional)                |
| **초기값** | nil을 가질 수 있으나, 사용 시 반드시 값이 있어야 함 | nil을 가질 수 있으며, 안전하게 사용 가능 |
| **사용 목적** | nil이 아님을 보장하는 경우에 사용 (예: IBOutlet 등) | nil 가능성을 고려하여 안전하게 사용 |
| **강제 언래핑** | 사용 시 강제 언래핑 필요 없음 (암시적 언래핑) | 사용 시 `!`로 강제 언래핑 필요 |
| **런타임 오류** | nil일 경우 런타임 오류 발생 | nil일 경우 안전하게 처리 가능 |

### 실행문에서 ?와 !의 차이점

|  구분  |          `?` (옵셔널 체이닝)          |          `!` (강제 언래핑)          |
|:------:|:--------------------------------------:|:-------------------------------------:|
| **사용법** | `let length = optionalString?.count` | `let length = optionalString!.count`  |
| **nil 처리** | nil일 경우 nil 반환                  | nil일 경우 런타임 오류 발생          |
| **안전성** | 안전하게 접근 가능                    | 위험성이 있음 (강제 언래핑)          |
| **예시** | `let name = user?.name` // user가 nil일 경우 name은 nil  | `let name = user!.name` // user가 nil일 경우 오류 발생 |

### 옵셔널 체이닝 예시

```swift
class Person {
    var name: String // 사람의 이름을 저장하는 변수
    var age: Int    // 사람의 나이를 저장하는 변수
    
    // 초기화 메서드
    init(name: String, age: Int) {
        self.name = name // name 매개변수를 인스턴스 변수에 할당
        self.age = age   // age 매개변수를 인스턴스 변수에 할당
    }
}

// Person 클래스의 인스턴스 kim 생성
let kim: Person = Person(name: "Kim", age: 20)
print(kim.age) // kim의 나이를 출력 (20)

// Person 클래스의 옵셔널 인스턴스 han 생성
let han: Person? = Person(name: "Han", age: 25)
print(han?.age) // 옵셔널 체이닝을 사용하여 han의 나이를 출력 (nil일 경우 nil 반환)

// 강제 언래핑
print(han!.age) // han이 nil이 아닐 경우 나이를 출력 (25), han이 nil일 경우 오류 발생

// 옵셔널 체이닝 후 강제 언래핑
print((han?.age)!) // han이 nil이 아닐 경우 나이를 출력 (25), han이 nil일 경우 오류 발생

// 옵셔널 바인딩을 사용하여 han의 나이를 안전하게 가져오기
if let hanAge = han?.age {
    print(hanAge) // hanAge가 nil이 아닐 경우 나이를 출력 (25)
} else {
    print("nil") // han이 nil일 경우 "nil" 출력
}
```

```swift
class Company {
    var ceo: Person? // 회사의 CEO를 나타내는 옵셔널 Person 타입 변수
}

class Person {
    var name: String // 사람의 이름을 저장하는 변수
    
    // 초기화 메서드
    init(name: String) {
        self.name = name // name 매개변수를 인스턴스 변수에 할당
    }
}

// Company 클래스의 인스턴스 apple 생성
class Company {
    var ceo: Person? // 회사의 CEO를 나타내는 옵셔널 Person 타입 변수
}

class Person {
    var name: String // 사람의 이름을 저장하는 변수
    
    // 초기화 메서드
    init(name: String) {
        self.name = name // name 매개변수를 인스턴스 변수에 할당
    }
}

// Company 클래스의 인스턴스 apple 생성
let apple = Company()

// apple의 CEO로 "Kim"이라는 이름을 가진 Person 인스턴스 할당
apple.ceo = Person(name: "Kim")

print(apple.ceo.name) // 옵셔널을 직접 접근, 오류 발생


// 옵셔널 체이닝 없이 사용 시, 안전성을 위해 if let 문 사용
if let ceo = apple.ceo {
    print(ceo.name) // ceo가 nil이 아닐 경우, ceo의 이름 출력 (Kim)
}

// 강제 언래핑을 사용하여 CEO의 이름을 출력
print(apple.ceo!.name) // "Kim" (apple.ceo가 nil이 아닐 때만 안전하게 사용 가능)

// 옵셔널 체이닝을 사용하여 CEO의 이름을 안전하게 가져오기
print(apple.ceo?.name) // Optional("Kim") (옵셔널로 이름을 반환)

// 옵셔널 체이닝과 옵셔널 바인딩을 사용하여 이름을 안전하게 출력
if let name = apple.ceo?.name {
    print(name) // "Kim" (name이 nil이 아닐 경우 출력)
}

// nil 병합 연산자를 사용하여 CEO가 없는 경우의 기본값 설정
print(apple.ceo?.name ?? "CEO가 없습니다") // "Kim" (apple.ceo가 nil이 아닐 경우 이름 출력, nil일 경우 "CEO가 없습니다" 출력)
```
